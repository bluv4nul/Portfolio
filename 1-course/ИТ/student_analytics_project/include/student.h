/**
 * @file student.h
 * @brief Определение структуры данных студента и функций для работы с ней.
 *
 * Этот заголовочный файл содержит определение структуры Student, которая
 * представляет информацию о студенте, включая его имя, оценки и статистические
 * показатели. Также здесь определены прототипы функций для работы с этими данными:
 * загрузка из CSV-файла, сортировка, расчет статистики и сохранение отчетов.
 *
 * @warning Вы, как студент, должны внимательно изучить структуру и комментарии,
 * чтобы понять принципы организации кода и документации в профессиональной
 * разработке.
 */

#ifndef STUDENT_H
#define STUDENT_H

#include <stdio.h>
#include <stdbool.h>

/**
 * @brief Максимальное количество оценок для одного студента.
 *
 * Это константа определяет максимальное количество оценок, которые могут быть
 * сохранены для каждого студента. Изменение этого значения требует пересмотра
 * логики работы с массивами оценок во всем проекте.
 */
#define MAX_SCORES 10

/**
 * @brief Максимальная длина имени студента.
 *
 * Определяет максимальное количество символов в имени студента, включая
 * завершающий нулевой символ. Выбрано достаточно большое значение для
 * поддержки полных имен с отчествами.
 */
#define MAX_NAME_LENGTH 100

/**
 * @brief Максимальная длина идентификатора студента.
 *
 * Определяет максимальное количество символов в идентификаторе студента,
 * включая завершающий нулевой символ.
 */
#define MAX_ID_LENGTH 20

/**
 * @brief Структура, представляющая данные о студенте.
 *
 * Эта структура содержит всю необходимую информацию о студенте:
 * идентификатор, имя, массив оценок, а также рассчитанные статистические
 * показатели (среднее значение, медиана, стандартное отклонение).
 */
typedef struct {
    /** Уникальный идентификатор студента */
    char id[MAX_ID_LENGTH];
    
    /** Полное имя студента */
    char name[MAX_NAME_LENGTH];
    
    /** Массив оценок студента */
    double scores[MAX_SCORES];
    
    /** Количество действительных оценок в массиве scores */
    int num_scores;
    
    /** Среднее значение оценок */
    double average;
    
    /** Медиана оценок */
    double median;
    
    /** Стандартное отклонение оценок */
    double std_deviation;
    
    /** Рейтинг студента (вычисляется на основе статистических показателей) */
    double rating;
} Student;

/**
 * @brief Загружает данные студентов из CSV-файла.
 *
 * Функция читает данные из указанного CSV-файла и заполняет массив структур Student.
 * Формат CSV-файла должен быть следующим:
 * ID,Name,Score1,Score2,...,ScoreN
 * 
 * @param filename Имя CSV-файла для чтения
 * @param students Указатель на массив структур Student для заполнения
 * @param max_students Максимальное количество студентов, которое может быть загружено
 * @return Количество успешно загруженных студентов или -1 в случае ошибки
 */
int load_students_csv(const char *filename, Student *students, size_t max_students);

/**
 * @brief Рассчитывает статистические показатели для студентов.
 *
 * Функция вычисляет среднее значение, медиану и стандартное отклонение оценок
 * для каждого студента в массиве, используя библиотеку GSL для статистических
 * расчетов.
 *
 * @param students Указатель на массив структур Student
 * @param count Количество студентов в массиве
 */
void calculate_statistics(Student *students, size_t count);

/**
 * @brief Сортирует студентов по указанному критерию.
 *
 * Функция сортирует массив студентов по выбранному критерию (среднему баллу,
 * медиане или рейтингу) в порядке убывания.
 *
 * @param students Указатель на массив структур Student
 * @param count Количество студентов в массиве
 * @param sort_by Строка, указывающая критерий сортировки ("average", "median", "rating")
 * @return true, если сортировка выполнена успешно, false в случае ошибки
 */
bool sort_students(Student *students, size_t count, const char *sort_by);

/**
 * @brief Сохраняет отчет о студентах в CSV-файл.
 *
 * Функция создает CSV-файл с данными о студентах, включая их идентификаторы,
 * имена и статистические показатели.
 *
 * @param filename Имя файла для сохранения отчета
 * @param students Указатель на массив структур Student
 * @param count Количество студентов в массиве
 * @return true, если отчет сохранен успешно, false в случае ошибки
 */
bool save_report_csv(const char *filename, const Student *students, size_t count);

/**
 * @brief Загружает дополнительные данные о студентах из интернета.
 *
 * Функция использует libcurl для загрузки дополнительных данных о студентах
 * с указанного URL. Данные должны быть в формате CSV.
 *
 * @param url URL для загрузки данных
 * @param students Указатель на массив структур Student
 * @param count Количество студентов в массиве
 * @return true, если данные загружены успешно, false в случае ошибки
 */
bool fetch_additional_data(const char *url, Student *students, size_t count);

/**
 * @brief Выводит информацию о студенте в консоль.
 *
 * Функция выводит подробную информацию о студенте, включая его идентификатор,
 * имя, оценки и статистические показатели.
 *
 * @param student Указатель на структуру Student
 */
void print_student(const Student *student);

/**
 * @brief Генерирует тестовый CSV-файл с данными студентов.
 *
 * Функция создает CSV-файл с тестовыми данными о студентах для демонстрации
 * работы программы.
 *
 * @param filename Имя файла для сохранения тестовых данных
 * @param num_students Количество студентов для генерации
 * @return true, если файл создан успешно, false в случае ошибки
 */
bool generate_test_data(const char *filename, size_t num_students);

#endif /* STUDENT_H */
